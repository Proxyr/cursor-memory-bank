# –ü–ê–ú–Ø–¢–¨ –ü–†–û–ï–ö–¢–ê: Forge.DependentFields

## üìã –û–ë–©–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø
- **–ú–æ–¥—É–ª—å**: forge.dependentfields (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω —Å forge.dadata)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ó–∞–≤–∏—Å–∏–º—ã–µ –ø–æ–ª—è –†–†–ö - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –ø–æ–ª–µ–π –∏ –±–ª–æ–∫–æ–≤ –≤ CRM —Ñ–æ—Ä–º–∞—Ö
- **–°—Ç–∞—Ç—É—Å**: BUILD MODE - –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- **–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞**: –¢–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è
- **–û—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ç–∞–ª–æ–≥**: local/modules/forge.dependentfields/

## üîß –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –ø—Ä–∞–≤–∏–ª (—á–µ–∫–±–æ–∫—Å "–ü—Ä–∞–≤–∏–ª–æ –≤–∫–ª—é—á–µ–Ω–æ")
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ ACTIVE –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ –ø—Ä–∞–≤–∏–ª
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è toggleRuleActivity() –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å–µ—Ä—ã–º —Ü–≤–µ—Ç–æ–º –≤ —Å–ø–∏—Å–∫–µ
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π —á–µ—Ä–µ–∑ iframe

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª–µ–π –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ JavaScript (async/await)
- ‚úÖ –ú–µ—Ç–æ–¥ loadFields() —Ç–µ–ø–µ—Ä—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –¥–æ populateForm()
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–±—à–∏—Ä–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º "- –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª–µ-—Ç—Ä–∏–≥–≥–µ—Ä -" –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

### 3. –í–∏–∑—É–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- ‚úÖ ID –ø—Ä–∞–≤–∏–ª —Å—Ç–∞–ª–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏ (–æ—Ç–∫—Ä—ã–≤–∞—é—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ hover –¥–ª—è –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- ‚úÖ –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ "–î–∞" (–∑–µ–ª–µ–Ω—ã–π) / "–ù–µ—Ç" (—Å–µ—Ä—ã–π)
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ CSS —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª

### 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏ (–Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ BLOCK_CID –≤ —Ç–∞–±–ª–∏—Ü—É forge_dependent_fields_rules
- ‚úÖ –ù–æ–≤—ã–π —Ç–∏–ø —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ª—è: "üî≤ –ë–ª–æ–∫ (—É–∫–∞–∂–∏—Ç–µ data-cid)"
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ data-cid –∞—Ç—Ä–∏–±—É—Ç–∞
- ‚úÖ JavaScript —Ñ—É–Ω–∫—Ü–∏—è toggleBlockCidField() –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –ø–æ–ª—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –±–ª–æ–∫–æ–≤ –≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª

### 5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–ª–µ–π
- ‚úÖ –ë–ª–æ–∫–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ –≤–µ—Ä—Ö —Å–ø–∏—Å–∫–∞ "–¢–æ–≥–¥–∞ –ø–æ–ª–µ"
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏ –∏ –ø–æ–ª—è–º–∏
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–µ–π—Å—Ç–≤–∏–π (—É–±—Ä–∞–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –±–ª–æ–∫–æ–≤)

### 6. –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞ –º–æ–¥—É–ª—è (info.php)
- ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏ –∏ –∫–∞—Ä—Ç–∞–º–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –±–ª–æ–∫–æ–≤
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π FAQ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
- ‚úÖ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

## üìÅ –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´

### PHP –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `local/components/forge/df.rule.edit/class.php` - –ª–æ–≥–∏–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª
- `local/components/forge/df.rule.edit/templates/.default/template.php` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- `local/components/forge/df.settings.list/class.php` - —Å–ø–∏—Å–æ–∫ –ø—Ä–∞–≤–∏–ª
- `local/components/forge/df.settings.list/templates/.default/template.php` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–ø–∏—Å–∫–∞

### JavaScript
- `local/modules/forge.dependentfields/install/js/forge_rule_edit.js` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- `local/modules/forge.dependentfields/lib/tables/RulesTable.php` - ORM –º–æ–¥–µ–ª—å

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `local/modules/forge.dependentfields/install/tools/info.php` - –ø–æ–¥—Å–∫–∞–∑–∫–∞ –º–æ–¥—É–ª—è

## üéØ –¢–ï–ö–£–©–ò–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò

### –û—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- –°–∫—Ä—ã—Ç—å/–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—è
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å/–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—è
- –†–µ–∂–∏–º "–¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ"

### –£—Å–ª–æ–≤–∏—è
- –†–∞–≤–Ω–æ/–ù–µ —Ä–∞–≤–Ω–æ
- –°–æ–¥–µ—Ä–∂–∏—Ç/–ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç
- –ü—É—Å—Ç–æ–µ/–ù–µ –ø—É—Å—Ç–æ–µ

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∞–º–∏
- –°–∫—Ä—ã—Ç–∏–µ/–ø–æ–∫–∞–∑ —Ü–µ–ª—ã—Ö —Å–µ–∫—Ü–∏–π —Ñ–æ—Ä–º—ã
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö data-cid –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –ø–æ–ª–µ–π –∏ –±–ª–æ–∫–æ–≤

## ‚ö†Ô∏è –ò–ó–í–ï–°–¢–ù–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò
- –ü–æ–ª–µ BLOCK_CID —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª)
- –ü–æ–ª–µ data-cid –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –±–ª–æ–∫–∞
- –û–¥–Ω–æ –ø—Ä–∞–≤–∏–ª–æ –Ω–∞ –æ–¥–Ω–æ –ø–æ–ª–µ
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø–æ–ª—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª–∞

## üîÑ –°–õ–ï–î–£–Æ–©–ò–ï –ó–ê–î–ê–ß–ò
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–æ–ª—è data-cid –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π (/crm/*/details/0/)
3. –°–æ–∑–¥–∞—Ç—å —Å–ª–∞–π–¥–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑ —É—Å–ª–æ–≤–∏–π (—Ç–æ–ª—å–∫–æ —Å–∫—Ä—ã—Ç–∏–µ –ø–æ–ª–µ–π/–±–ª–æ–∫–æ–≤)

## üìä –°–¢–†–£–ö–¢–£–†–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•
```sql
TABLE: forge_dependent_fields_rules
- ID (int, auto_increment, primary key)
- ENTITY_TYPE_ID (int) 
- DEPENDENT_FIELD_ID (varchar)
- CONDITION (varchar)
- VALUE (text)
- FIELD_ID (varchar)
- ACTION (varchar) 
- ACTIVE (char(1), default 'Y')
- BLOCK_CID (varchar(100), nullable) -- –ù–æ–≤–æ–µ –ø–æ–ª–µ
- DATE_CREATE (datetime)
- DATE_UPDATE (datetime)
``` 